<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Disease Prediction</title>
  <meta content="" name="description">
  <meta content="" name="keywords">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Roboto:300,300i,400,400i,500,500i,700,700i&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="static/vendor/animate.css/animate.min.css" rel="stylesheet">
  <link href="static/vendor/aos/aos.css" rel="stylesheet">
  <link href="static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="static/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="static/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="static/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="static/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="static/css/style.css" rel="stylesheet">

  <style>
    #loadingSpinner {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}


.prediction-table {
  font-family: Arial, sans-serif;
}

.prediction-table table {
  width: 100%;
  border-collapse: collapse;
  border: 2px solid #07a028;
}

.prediction-table th, .prediction-table td {
  padding: 8px;
  text-align: left;
  border: 2px solid #07a028;
}

.prediction-table th {
  background-color: #f2f2f2;
  font-weight: bold;
}


  </style>

  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
<script type="text/javascript"> 
  function preventBack() { 
      window.history.forward();  
  } 
    
  setTimeout("preventBack()", 0); 
    
  window.onunload = function () { null }; 
</script> 
</head>

<body style="background-color: #34c759;"> 
  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top d-flex align-items-center">
    <div class="container d-flex justify-content-between align-items-center">
      <div class="logo">
        <h1 class="text-light"><a href="/"><span>LEAFSCAN</span></a></h1>
      </div>
      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="" href="/home">Home</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="/services">Services</a></li>
          <li><a class="active" href="/predict">Disease Prediction</a></li>
          <li><a href="/contact">Contact Us</a></li>
          <li><a href="/logout">Logout</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav>
    </div>
  </header><!-- End Header -->

  <br><br><br><br>
    <div class="container">
      <div class="row">
        <div class="col mx-auto">
          <div class="p-5 bg-white shadow rounded-lg" style="height: 95%;">
            <h5><b>Why is it necessary to detect disease in leaf?</b></h5>
            <p>Leaf diseases affect the growth of their respective species. In addition, some research gaps are identified from which to obtain greater transparency for detecting diseases in plants, even before their symptoms appear clearly. Diagnosis is one of the most important aspects of a plant pathologist's training. Without proper identification of the disease and the disease-causing agent, disease control measures can be a waste of time and money and can lead to further plant losses. Proper disease diagnosis is necessary.</p>
          </div>
        </div>
        <div class="col mx-auto">
          <div class="p-5 bg-white shadow rounded-lg" style="height: 95%; background-color: #34c759;">
            <img id="imagePreview" src="/static/img/back.jpg" height="250" alt="" width="250" class="d-block mx-auto mb-4 rounded-pill">
            <div id="loadingSpinner" class="spinner-border text-success" role="status" style="display: none;">
              <span class="visually-hidden">Loading...</span>
            </div>
            <center><div><font color="black"><b>Please Upload a Leaf Image for Detecting Leaf Disease.</b></font></div><br>
            
<button style="background-color: #34c759;" type="button" onclick="selectImage()"><font color="white"><b>Select Image</b></font></button>
<input type="file" id="imageUpload" accept="image/*" style="display:none;">
</center>
<div id="label-container"></div>
          </div>
        </div>
        <div class="col mx-auto">
          <div class="p-5 bg-white shadow rounded-lg" style="height: 95%;">
            <h5><b>Prevent leaf disease  by the following steps:</b></h5>
            <ol>
              <li>Follow Good Sanitation Practices.</li>
              <li>Fertilize to Keep Your Plants Healthy.</li>
              <li>Inspect Plants for Diseases Before You Bring Them Home.</li>
              <li>Allow the Soil to Warm Before Planting.</li>
              <li>Ensure a Healthy Vegetable Garden By Rotating Crops.</li>
              <li>Provide Good Air Circulation</li>
              <li>Remove Diseased Stems and Foliage</li>
            </ol>
            <a target="_blank" href="https://www.thespruce.com/prevent-plant-diseases-in-your-garden-2539511" class="mx-2"><button type="button" class="btn btn-outline-success">More info</button></a>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    document.getElementById('choose-btn').addEventListener('click', function () {
      document.getElementById('actual-btn').click();
    });

    // Update the displayed file name when a file is chosen
    document.getElementById('actual-btn').addEventListener('change', function () {
      var fileName = this.files[0].name;
      document.querySelector('label[for="actual-btn"]').innerText = fileName;
    });
  </script>
  <!-- ======= Footer ======= -->
  <footer id="footer" data-aos="fade-up" data-aos-easing="ease-in-out" data-aos-duration="500">

    <div class="footer-newsletter">
      <div class="container">
        <div class="row">
          <div class="col-lg-6">
            <h4>Our Newsletter</h4>
            <p>The Leaf Disease Detection and Classification System aims to address the urgent need for a efficient solution to identify and categorize diseases affecting leaves.</p>
          </div>
          <div class="col-lg-6">
            <form action="" method="post">
              <input type="email" name="email"><input type="submit" value="Subscribe">
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="footer-top">
      <div class="container">
        <div class="row">

          <div class="col-lg-3 col-md-6 footer-links">
            <h4>Useful Links</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a href="/">Home</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">About us</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Services</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Terms of service</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Privacy policy</a></li>
            </ul>
          </div>

          <div class="col-lg-3 col-md-6 footer-links">
            <h4>Our Services</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Web Design</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Web Development</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Product Management</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Marketing</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Graphic Design</a></li>
            </ul>
          </div>

          <div class="col-lg-3 col-md-6 footer-contact">
            <h4>Contact Us</h4>
            <p>
              A108 Adam Street <br>
              New York, NY 535022<br>
              United States <br><br>
              <strong>Phone:</strong> +91 8846775393 <br>
              <strong>Email:</strong> leafscan@gmail.com<br>
            </p>

          </div>

          <div class="col-lg-3 col-md-6 footer-info">
            <h3>About Leafscan</h3>
            <p>Cras fermentum odio eu feugiat lide par naso tierra. Justo eget nada terra videa magna derita valies darta donna mare fermentum iaculis eu non diam phasellus.</p>
            <div class="social-links mt-3">
              <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
              <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
              <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
              <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="container">
      <div class="copyright">
        &copy; Copyright <strong><span>Leafscan</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/free-bootstrap-template-corporate-moderna/ -->
        
      </div>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="static/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="static/vendor/aos/aos.js"></script>
  <script src="static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="static/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="static/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="static/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="static/vendor/waypoints/noframework.waypoints.js"></script>
  <script src="static/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="static/js/main.js"></script>
  <script type="text/javascript">
    // the link to your model provided by Teachable Machine export panel
    const URL = "static/json/";

    let model, maxPredictions;

    // Load the image model
    async function init() {
        const modelURL = URL + "model.json";
        const metadataURL = URL + "metadata.json";

        // load the model and metadata
        model = await tmImage.load(modelURL, metadataURL);
        maxPredictions = model.getTotalClasses();
    }

    // Function to handle file selection
    function selectImage() {
        document.getElementById('imageUpload').click();
    }

    // Function to handle file upload
// Function to handle file upload
// Function to handle file upload
async function handleImageUpload(event) {
    const file = event.target.files[0];
    const img = new Image();
    const reader = new FileReader();

    // Show loading spinner
    document.getElementById('loadingSpinner').style.display = 'block';

    reader.onload = async function (e) {
        img.src = e.target.result;
        img.onload = async function () {
            document.getElementById('imagePreview').src = img.src; // Set the selected image
            await predict(img);
            // Hide loading spinner after prediction is complete
            document.getElementById('loadingSpinner').style.display = 'none';
        }
    }
    reader.readAsDataURL(file);
}



    // Run the image through the image model
// Run the image through the image model
async function predict(img) {
    const prediction = await model.predict(img);
    let maxProbability = 0;
    let predictedClass = '';

    // Find the class with the highest probability
    for (let i = 0; i < prediction.length; i++) {
        if (prediction[i].probability > maxProbability) {
            maxProbability = prediction[i].probability;
            predictedClass = prediction[i].className;
        }
    }

    // Display the class name and accuracy of the highest probability class
    const labelContainer = document.getElementById("label-container");
    labelContainer.innerHTML = `<br><div class="prediction-table"><table><tr><th><center><font color="blue">Disease</font></center></th><th><font color="blue">Accuracy</font></th></tr><tr><td><font color="orangered"><b>${predictedClass}</b></font></td><td><font color="orangered"><b>${(maxProbability * 100).toFixed(2)}%</b></font></td></tr></table></div>`;
    
}


    // Initialize the model when the page loads
    init();

    // Add event listener to handle file upload
    document.getElementById('imageUpload').addEventListener('change', handleImageUpload);
</script>

</body>

</html>

  